<div class="container slide-up-in">
	<dav-header
		size="lg"
		addButtonVisible
		(addButtonClick)="createTodoDialog.show()"
	>
		{{ locale.title }}
	</dav-header>

	<!--
	<p
		class="no-items-message font-weight-light text-center mt-3"
		*ngIf="
			dataService.todosWithoutDate.todos.length == 0 &&
			dataService.todosWithoutDate.todoLists.length == 0 &&
			dataService.todoDays.length == 0 &&
			dataService.todosWithoutGroup.length == 0 &&
			dataService.todoListsWithoutGroup.length == 0 &&
			dataService.todoGroups.length == 0
		"
	>
		{{ locale.noTodos }}
	</p>
	-->

	<div class="todos-list">
		@if (dataService.sortTodosByDate) {
		<!-- Sort by date -->
		<div
			class="card offset-1 col-11 col-md-9 col-lg-7 mx-auto my-4 ms-depth-4"
		>
			<ul class="list-group list-group-flush">
				<calendo-todo-item
					[todo]="todo"
					(delete)="DeleteTodo(todo)"
					*ngFor="let todo of todosWithoutDate"
				></calendo-todo-item>

				<calendo-todo-list-item
					[todoList]="todoList"
					*ngFor="let todoList of todoListsWithoutDate"
				></calendo-todo-list-item>
			</ul>
		</div>

		<div
			class="card offset-1 col-11 col-md-9 col-lg-7 mx-auto my-4 ms-depth-4"
			*ngFor="let todoDay of todoDays"
			[ngClass]="
				todoDay.todos.length > 0 || todoDay.todoLists.length > 0
					? ''
					: 'hidden'
			"
		>
			<div class="card-body">
				<h5
					class="card-title"
					*ngIf="todoDay.todos.length > 0 || todoDay.todoLists.length > 0"
				>
					<span (click)="ShowCalendarDay(todoDay.timestamp)">
						{{ todoDay.formattedDate }}
					</span>
				</h5>

				<ul class="list-group list-group-flush">
					<calendo-todo-item
						[todo]="todo"
						(delete)="DeleteTodo(todo)"
						*ngFor="let todo of todoDay.todos"
					></calendo-todo-item>
					<calendo-todo-list-item
						[todoList]="todoList"
						*ngFor="let todoList of todoDay.todoLists"
					></calendo-todo-list-item>
				</ul>
			</div>
		</div>
		} @else {
		<!-- Sort by group -->
		<div
			class="card offset-1 col-11 col-md-9 col-lg-7 mx-auto my-4 ms-depth-4"
		>
			<ul class="list-group list-group-flush">
				<calendo-todo-item
					[todo]="todo"
					(delete)="DeleteTodo(todo)"
					[showBadge]="false"
					*ngFor="let todo of todosWithoutGroup"
				></calendo-todo-item>
				<calendo-todo-list-item
					[todoList]="todoList"
					*ngFor="let todoList of todoListsWithoutGroup"
				></calendo-todo-list-item>
			</ul>
		</div>

		<div
			class="card offset-1 col-11 col-md-9 col-lg-7 mx-auto my-4 ms-depth-4"
			*ngFor="let todoGroup of todoGroups"
			[ngClass]="
				todoGroup.todos.length > 0 || todoGroup.todoLists.length > 0
					? ''
					: 'hidden'
			"
		>
			<div class="card-body">
				<h5
					class="card-title"
					*ngIf="
						todoGroup.todos.length > 0 || todoGroup.todoLists.length > 0
					"
				>
					{{ todoGroup.name }}
				</h5>
				<ul class="list-group list-group-flush">
					<calendo-todo-item
						[todo]="todo"
						(delete)="DeleteTodo(todo)"
						[showBadge]="false"
						*ngFor="let todo of todoGroup.todos"
					></calendo-todo-item>
					<calendo-todo-list-item
						[todoList]="todoList"
						(update)="TodoListUpdated(todoList.uuid, todoGroup.name)"
						*ngFor="let todoList of todoGroup.todoLists"
					></calendo-todo-list-item>
				</ul>
			</div>
		</div>
		}
	</div>
</div>

<calendo-create-todo-dialog
	#createTodoDialog
	(primaryButtonClick)="createTodo($event)"
></calendo-create-todo-dialog>
