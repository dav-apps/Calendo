<div class="container slide-up-in">
	<div class="head">
		<h1 class="headline">{{ currentWeekday }}</h1>
		<h3 class="subhead">{{ currentDate }}</h3>
	</div>

	<div class="row mt-4">
		<div class="card col-10 offset-1 col-md-4 mb-5 ms-depth-4">
			<div class="card-body" style="padding-bottom: 0px">
				<h5 class="card-title">{{ locale.appointments }}</h5>
				<ul class="list-group list-group-flush">
					@for (appointment of currentDay.appointments; track
					appointment.uuid) {
					<calendo-appointment-item
						[appointment]="appointment"
						[showCompleted]="true"
						(delete)="showDeleteAppointmentDialog(appointment)"
					></calendo-appointment-item>
					}

					<li class="list-group-item" style="padding: 14px 0px 14px 5px">
						<button
							type="button"
							class="btn btn-outline-primary btn-sm"
							(click)="createAppointmentDialog.show()"
						>
							<fa-icon [icon]="faPlus"></fa-icon>
						</button>
					</li>
				</ul>
			</div>
		</div>

		<div class="card col-10 offset-1 col-md-4 offset-md-2 mb-5 ms-depth-4">
			<div class="card-body" style="padding-bottom: 0px">
				<h5 class="card-title">{{ locale.todos }}</h5>
				<ul class="list-group list-group-flush">
					@for (todo of currentDay.todos; track todo.uuid) {
					<calendo-todo-item
						[todo]="todo"
						(delete)="DeleteTodo(todo)"
					></calendo-todo-item>
					} @for (todoList of currentDay.todoLists; track todoList.uuid) {
					<calendo-todo-list-item
						[todoList]="todoList"
					></calendo-todo-list-item>
					}

					<li
						class="list-group-item"
						style="padding: 14px 0px 14px 5px"
						ngbDropdown
						placement="bottom-left"
					>
						<button
							type="button"
							class="btn btn-outline-primary btn-sm"
							(click)="createTodoDialog.show()"
						>
							<fa-icon [icon]="faPlus"></fa-icon>
						</button>
					</li>
				</ul>
			</div>
		</div>
	</div>

	<div class="container">
		@for (day of days; track day.formattedDate) {
		<div
			class="row py-4 ml-md-4 border-top"
			[ngClass]="dataService.darkTheme ? 'border-dark' : ''"
		>
			<div class="col-3">
				<h4 class="cursor">
					{{ GetLargeDate(day.date) }}
				</h4>
				<p class="font-weight-light cursor">
					{{ GetSmallDate(day.date) }}
				</p>
			</div>
			<div
				class="offset-1 col-8 offset-lg-0 col-lg-9 d-flex flex-column mt-1"
			>
				@for (appointment of day.appointments; track appointment.uuid) {
				<div class="d-inline-flex">
					<calendo-small-appointment-item
						[appointment]="appointment"
						(delete)="deleteAppointmentDialog.show()"
						(contextmenu)="
							smallAppointmentItemContextMenu($event, appointment)
						"
					></calendo-small-appointment-item>
				</div>
				}

				<div class="d-flex flex-wrap">
					@for (todo of day.todos; track todo.uuid) {
					<calendo-small-todo-item
						[todo]="todo"
						(delete)="DeleteTodo(todo)"
					></calendo-small-todo-item>
					} @for (todoList of day.todoLists; track todoList.uuid) {
					<calendo-small-todo-list-item
						[todoList]="todoList"
					></calendo-small-todo-list-item>
					}
				</div>
			</div>
		</div>
		}
	</div>
</div>

<dav-context-menu
	#contextMenu
	[visible]="contextMenuVisible"
	[posX]="contextMenuPositionX"
	[posY]="contextMenuPositionY"
>
	<!-- Edit -->
	<dav-context-menu-item
		[value]="actionsLocale.edit"
		(click)="showEditAppointmentDialog(selectedAppointment)"
	>
		<fa-icon slot="icon" [icon]="faEditLight"></fa-icon>
	</dav-context-menu-item>

	<!-- Delete -->
	<dav-context-menu-item
		[value]="actionsLocale.delete"
		(click)="showDeleteAppointmentDialog(selectedAppointment)"
	>
		<fa-icon slot="icon" [icon]="faTrashLight"></fa-icon>
	</dav-context-menu-item>
</dav-context-menu>

<calendo-appointment-dialog
	#createAppointmentDialog
	(primaryButtonClick)="createAppointment($event)"
></calendo-appointment-dialog>

<calendo-appointment-dialog
	#editAppointmentDialog
	mode="edit"
	(primaryButtonClick)="updateAppointment($event)"
></calendo-appointment-dialog>

<calendo-create-todo-dialog
	#createTodoDialog
	(primaryButtonClick)="createTodo($event)"
></calendo-create-todo-dialog>

<calendo-delete-appointment-dialog
	#deleteAppointmentDialog
	(primaryButtonClick)="deleteAppointment()"
></calendo-delete-appointment-dialog>
